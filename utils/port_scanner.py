from utils.get_service import get_service

def port_scanner_range(s, host, port_range, protocol="tcp"):
    start = port_range[0]
    end = port_range[1]
    for p in range(start, end):
        #serivce = socket.getservbyport(p, protocol)
        result = s.connect_ex((host, p))
        if result == 0:
            service = get_service(p)
            print("Port {0} is open: {1}".format(p, service))
        else:
            print("The port {0} is closed!".format(p))

def port_scanner(s, host, port):
    result = s.connect_ex((host, port))
    if result == 0:
        service = get_service(port)
        print("Port {0} is open: {1}".format(port, service))
    else:
        print("The port {0} is closed!".format(port))