from click import argument
from utils.get_info import get_hostname, get_service, get_state
from utils.print_info import print_info

def port_scanner_range(s, host, port_range, protocol="tcp"):
    start = port_range[0]
    end = port_range[1]
    res = list()
    for p in range(start, end):
        result = s.scan(host, str(p), arguments='--host-timeout 100')
        res.append(
            [
                p,
                get_service(result, host, p),
                get_state(result, host, p),
            ])
    return [res, get_hostname(result, host)]

def port_scanner(s, host, port):
    result = s.scan(host, str(port))
    print(result)
    res = [port,
           get_service(result, host, port),
           get_state(result, host, port)]
    return [res, get_hostname(result, host)] 
    