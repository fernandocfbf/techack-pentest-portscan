from utils.port_scanner import port_scanner, port_scanner_range, port_scanner_most_common
from utils.get_info import get_hostname
from utils.print_info import print_info

from constants.constants import MOST_COMMON

def handle_submit(s, hostname, port, start, end):
    try:
        if (start == '' or end == '') and port == "":
            resp_, hostname_transformed = port_scanner_most_common(s, hostname, MOST_COMMON)

        elif (start == '' or end == ''):
            resp_, hostname_transformed = port_scanner(s, hostname, int(port))
            resp = [resp_]

        else:
            resp, hostname_transformed = port_scanner_range(s, hostname, [int(start), int(end)])
        print("Scannning host {0} ({1})".format(hostname, hostname_transformed))
        print_info(resp)
    except NameError as error:
        print("Host {0} seems down".format(hostname))
